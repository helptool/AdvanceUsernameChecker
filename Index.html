<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AvgecFinder — Instagram Username Checker</title>
  <style>
    body {
      background: #0b0e17;
      color: #e6edf5;
      font-family: "Poppins", sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    .card {
      width: 90%;
      max-width: 650px;
      background: #141b2e;
      border-radius: 16px;
      padding: 25px;
      margin-top: 40px;
      box-shadow: 0 0 25px rgba(0,0,0,0.5);
    }
    h1 {
      text-align: center;
      color: #8b5cf6;
      font-weight: 700;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: 500;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      border-radius: 8px;
      border: none;
      font-size: 15px;
    }
    input {
      background: #111827;
      color: #fff;
      border: 1px solid #2d3748;
    }
    button {
      background: linear-gradient(90deg, #8b5cf6, #06b6d4);
      color: white;
      font-weight: 600;
      margin-top: 15px;
      cursor: pointer;
    }
    button:hover {
      opacity: 0.9;
    }
    #results {
      margin-top: 20px;
      max-height: 400px;
      overflow-y: auto;
      font-family: monospace;
      border-top: 1px solid #2a3550;
      padding-top: 10px;
    }
    .ok { color: #10b981; }
    .bad { color: #ef4444; }
    .username-line {
      display: flex;
      justify-content: space-between;
      padding: 3px 0;
    }
    .copy-btn {
      background: none;
      border: none;
      color: #8b5cf6;
      cursor: pointer;
      font-size: 14px;
    }
    .copy-btn:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>AvgecFinder</h1>

    <label>Username length</label>
    <input id="length" type="number" min="1" max="15" value="4">

    <label>Pattern (use _ for blanks, e.g. a__y)</label>
    <input id="pattern" type="text" placeholder="Use _ for blanks (optional)">

    <button id="checkBtn">Generate & Check</button>

    <div id="status"></div>
    <div id="results"></div>
  </div>

  <script>
    const chars = "abcdefghijklmnopqrstuvwxyz0123456789._";
    const api = "https://instagram-username-checker.vercel.app/api/check?username=";

    document.getElementById("checkBtn").onclick = async () => {
      const len = +document.getElementById("length").value;
      const pattern = document.getElementById("pattern").value || "_".repeat(len);
      const resultsDiv = document.getElementById("results");
      const statusDiv = document.getElementById("status");

      resultsDiv.innerHTML = "";
      statusDiv.textContent = "Generating combinations...";

      const combos = [];
      function generate(prefix, i) {
        if (i === pattern.length) {
          combos.push(prefix);
          return;
        }
        if (pattern[i] === "_") {
          for (let c of chars) generate(prefix + c, i + 1);
        } else {
          generate(prefix + pattern[i], i + 1);
        }
      }
      generate("", 0);

      statusDiv.textContent = `Generated ${combos.length} usernames. Checking...`;
      let available = 0;

      for (let i = 0; i < combos.length; i++) {
        const username = combos[i];
        try {
          const res = await fetch(api + username);
          const data = await res.json();
          const el = document.createElement("div");
          el.className = "username-line";

          if (data.available) {
            el.innerHTML = `✅ <span class='ok'>${username}</span> <button class='copy-btn' onclick="navigator.clipboard.writeText('${username}')">copy</button>`;
            available++;
          } else {
            el.innerHTML = `❌ <span class='bad'>${username}</span>`;
          }

          resultsDiv.appendChild(el);
          statusDiv.textContent = `Checked ${i + 1}/${combos.length} — ${available} available`;
        } catch (err) {
          console.error(err);
        }
      }
      statusDiv.textContent = `✅ Done — ${available} available usernames`;
    };
  </script>
</body>
</html>

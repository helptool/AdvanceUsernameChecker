<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AvgecFinder — Instagram Username Checker</title>
  <style>
    body {
      background: #0c0f18;
      color: #f2f5fc;
      font-family: "Poppins", sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      width: 95%;
      max-width: 700px;
      background: #141b2e;
      margin-top: 40px;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 25px rgba(0,0,0,0.5);
    }
    h1 {
      text-align: center;
      color: #8b5cf6;
      font-weight: 700;
      margin-bottom: 25px;
    }
    label { display: block; margin-top: 15px; font-weight: 500; }
    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      border-radius: 8px;
      border: none;
      font-size: 15px;
    }
    input {
      background: #111827;
      color: #fff;
      border: 1px solid #2d3748;
    }
    button {
      background: linear-gradient(90deg, #8b5cf6, #06b6d4);
      color: white;
      font-weight: 600;
      margin-top: 15px;
      cursor: pointer;
    }
    button:hover { opacity: 0.9; }
    #results {
      margin-top: 20px;
      max-height: 400px;
      overflow-y: auto;
      font-family: monospace;
      border-top: 1px solid #2a3550;
      padding-top: 10px;
    }
    .ok { color: #10b981; }
    .bad { color: #ef4444; }
    .username-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 4px 0;
    }
    .copy-btn {
      background: none;
      border: none;
      color: #8b5cf6;
      cursor: pointer;
      font-size: 13px;
    }
    .copy-btn:hover { text-decoration: underline; }
    #status { margin-top: 10px; color: #06b6d4; font-size: 15px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>AvgecFinder</h1>
    <label>Username length</label>
    <input id="length" type="number" min="1" max="15" value="4">

    <label>Pattern (use _ for blanks, e.g. a__y)</label>
    <input id="pattern" type="text" placeholder="Use _ for blanks (optional)">

    <button id="startBtn">Start Checking</button>
    <button id="stopBtn" style="background:#ef4444;display:none;">Stop</button>

    <div id="status"></div>
    <div id="results"></div>
  </div>

  <script>
    const letters = "abcdefghijklmnopqrstuvwxyz";
    const numbers = "0123456789";
    const specials = "._";
    const api = "https://instagram-username-checker.vercel.app/api/check?username=";

    let stopFlag = false;

    document.getElementById("startBtn").onclick = startChecking;
    document.getElementById("stopBtn").onclick = () => {
      stopFlag = true;
      document.getElementById("status").textContent = "⛔ Stopped by user.";
      document.getElementById("startBtn").style.display = "block";
      document.getElementById("stopBtn").style.display = "none";
    };

    async function startChecking() {
      stopFlag = false;
      document.getElementById("results").innerHTML = "";
      const statusDiv = document.getElementById("status");
      const len = +document.getElementById("length").value;
      const pattern = document.getElementById("pattern").value || "_".repeat(len);

      document.getElementById("startBtn").style.display = "none";
      document.getElementById("stopBtn").style.display = "block";

      const chars = [...letters, ...numbers, ...specials];
      const combos = [];

      function generate(prefix, i) {
        if (i === pattern.length) {
          combos.push(prefix);
          return;
        }
        if (pattern[i] === "_") {
          for (let c of chars) generate(prefix + c, i + 1);
        } else {
          generate(prefix + pattern[i], i + 1);
        }
      }

      statusDiv.textContent = "Generating usernames...";
      generate("", 0);
      statusDiv.textContent = `Checking ${combos.length} usernames...`;

      let available = 0;

      for (let i = 0; i < combos.length; i++) {
        if (stopFlag) break;

        const username = combos[i];
        const res = await fetch(api + username);
        const data = await res.json();

        const el = document.createElement("div");
        el.className = "username-line";

        if (data.available) {
          el.innerHTML = `✅ <span class='ok'>${username}</span> <button class='copy-btn' onclick="navigator.clipboard.writeText('${username}')">copy</button>`;
          available++;
        } else {
          el.innerHTML = `❌ <span class='bad'>${username}</span>`;
        }

        document.getElementById("results").appendChild(el);
        statusDiv.textContent = `Checked ${i + 1}/${combos.length} — ${available} available`;
      }

      if (!stopFlag) {
        statusDiv.textContent = `✅ Completed — ${available} usernames available`;
      }
      document.getElementById("startBtn").style.display = "block";
      document.getElementById("stopBtn").style.display = "none";
    }
  </script>
</body>
</html>
